"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
print(csfe_qh1)
# -quarterly--------------------h4
csfe_qh4 <- CSFE_q %>%
ggplot(aes(x=date, y= csfe_h4, color = model)) +
geom_line(linewidth=0.8) +
geom_hline(yintercept = 0, color = "black", linetype = "dashed") +
labs(title = "Horizon 4",
subtitle =  "Data from 2Q2018 to 1Q2025",
x = "Date",
y = "CSFE",
color = "Model") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_color_discrete(labels = c(
"lasso" = "Lasso",
"enet" = "Elastic Net",
"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
print(csfe_qh4)
# -quarterly--------------------save
ggsave("Plots/Csfe - Qh1.png", csfe_qh1, width = 8, height = 6, dpi = 225)
ggsave("Plots/Csfe - Qh4.png", csfe_qh4, width = 8, height = 6, dpi = 225)
# -monthly--------------------h1
csfe_mh1 <- CSFE_m %>%
ggplot(aes(x=date, y= csfe_h1, color = model)) +
geom_line(linewidth=0.8) +
geom_hline(yintercept = 0, color = "black", linetype = "dashed") +
labs(title = "Horizon 1",
subtitle =  "Data from Sep/2018 to May/2025",
x = "Date",
y = "CSFE",
color = "Model:") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_color_discrete(labels = c(
"lasso" = "Lasso",
"enet" = "Elastic Net",
"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
library(ggplot2)
library(dplyr)
library(ggthemes)
library(tidyr)
library(stringr)
library(showtext)
library(sysfonts)
sysfonts::font_add_google("EB Garamond")
showtext::showtext_auto()
# -monthly--------------------h1
csfe_mh1 <- CSFE_m %>%
ggplot(aes(x=date, y= csfe_h1, color = model)) +
geom_line(linewidth=0.8) +
geom_hline(yintercept = 0, color = "black", linetype = "dashed") +
labs(title = "Horizon 1",
subtitle =  "Data from Sep/2018 to May/2025",
x = "Date",
y = "CSFE",
color = "Model:") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_color_discrete(labels = c(
"lasso" = "Lasso",
"enet" = "Elastic Net",
"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
print(csfe_mh1)
# -monthly--------------------h12
csfe_mh12 <- CSFE_m %>%
ggplot(aes(x=date, y= csfe_h12, color = model)) +
geom_line(linewidth=0.8) +
geom_hline(yintercept = 0, color = "black", linetype = "dashed") +
labs(title = "Horizon 12",
subtitle =  "Data from Sep/2018 to May/2025",
x = "Date",
y = "CSFE",
color = "Model:") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_color_discrete(labels = c(
"lasso" = "Lasso",
"enet" = "Elastic Net",
"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
ggsave("Plots/Csfe - Mh1.png", csfe_mh1, width = 6, height = 4, dpi = 300)
ggsave("Plots/Csfe - Mh12.png", csfe_mh12, width = 6, height = 4, dpi = 300)
# -quarterly--------------------h1
csfe_qh1 <- CSFE_q %>%
ggplot(aes(x=date, y= csfe_h1, color = model)) +
geom_line(linewidth=0.8) +
geom_hline(yintercept = 0, color = "black", linetype = "dashed") +
labs(title = "Horizon 1",
subtitle =  "Data from 2Q2018 to 1Q2025",
x = "Date",
y = "CSFE",
color = "Model:") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_color_discrete(labels = c(
"lasso" = "Lasso",
"enet" = "Elastic Net",
"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
# -quarterly--------------------h4
csfe_qh4 <- CSFE_q %>%
ggplot(aes(x=date, y= csfe_h4, color = model)) +
geom_line(linewidth=0.8) +
geom_hline(yintercept = 0, color = "black", linetype = "dashed") +
labs(title = "Horizon 4",
subtitle =  "Data from 2Q2018 to 1Q2025",
x = "Date",
y = "CSFE",
color = "Model:") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_color_discrete(labels = c(
"lasso" = "Lasso",
"enet" = "Elastic Net",
"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
ggsave("Plots/Csfe - Mh1.png", csfe_qh1, width = 8, height = 6, dpi = 225)
ggsave("Plots/Csfe - Mh12.png", csfe_qh4, width = 8, height = 6, dpi = 225)
ggsave("Plots/Csfe - Qh1.png", csfe_qh1, width = 8, height = 6, dpi = 225)
ggsave("Plots/Csfe - Qh4.png", csfe_qh4, width = 8, height = 6, dpi = 225)
# -monthly--------------------h12
csfe_mh12 <- CSFE_m %>%
ggplot(aes(x=date, y= csfe_h12, color = model)) +
geom_line(linewidth=0.8) +
geom_hline(yintercept = 0, color = "black", linetype = "dashed") +
labs(title = "Horizon 12",
subtitle =  "Data from Sep/2018 to May/2025",
x = "Date",
y = "CSFE",
color = "Model:") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_color_discrete(labels = c(
"lasso" = "Lasso",
"enet" = "Elastic Net",
"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
rm(CSFE_m, csfe_mh1, csfe_mh12)
CSFE_m <- csfe_m %>%
pivot_longer(
cols = -date,
names_to = c("model", "horizon"),
names_sep = "_"
) %>%
pivot_wider(
names_from = horizon,
values_from = value,
names_prefix = "csfe_"
)
# -monthly--------------------h1
csfe_mh1 <- CSFE_m %>%
ggplot(aes(x=date, y= csfe_h1, color = model)) +
geom_line(linewidth=0.8) +
geom_hline(yintercept = 0, color = "black", linetype = "dashed") +
labs(title = "Horizon 1",
subtitle =  "Data from Sep/2018 to May/2025",
x = "Date",
y = "CSFE",
color = "Model:") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_color_discrete(labels = c(
"lasso" = "Lasso",
"enet" = "Elastic Net",
"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
print(csfe_mh1)
# -monthly--------------------h12
csfe_mh12 <- CSFE_m %>%
ggplot(aes(x=date, y= csfe_h12, color = model)) +
geom_line(linewidth=0.8) +
geom_hline(yintercept = 0, color = "black", linetype = "dashed") +
labs(title = "Horizon 12",
subtitle =  "Data from Sep/2018 to May/2025",
x = "Date",
y = "CSFE",
color = "Model:") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_color_discrete(labels = c(
"lasso" = "Lasso",
"enet" = "Elastic Net",
"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
print(csfe_mh12)
# -monthly--------------------save
ggsave("Plots/Csfe - Mh1.png", csfe_qh1, width = 8, height = 6, dpi = 225)
ggsave("Plots/Csfe - Mh12.png", csfe_qh4, width = 8, height = 6, dpi = 225)
message("[9] Evaluating through CSFE (Welch and Goyal, 2008)")
mcsfe_lasso = csfe1(lasso_model, benchmark, ym)
mcsfe_enet = csfe1(enet_model, benchmark, ym)
mcsfe_rf = csfe1(rf_model, benchmark, ym)
mcsfe_lasso <- as.data.frame(mcsfe_lasso)
mcsfe_enet <- as.data.frame(mcsfe_enet)
mcsfe_rf <- as.data.frame(mcsfe_rf)
# ================================================
# -----------------DF - Graphs--------------------
# ================================================
message("[10] Collecting results for graph building (see 10_get_Graphs.R)")
y_axis <- datem[189:269]
csfe_m <- data.frame(date = y_axis,
lasso_h1 = mcsfe_lasso$h1,
lasso_h12 = mcsfe_lasso$h12,
enet_h1 = mcsfe_enet$h1,
enet_h12 = mcsfe_enet$h12,
rf_h1 = mcsfe_rf$h1,
rf_h12 = mcsfe_rf$h12)
forecast_bench <- as.data.frame(benchmark$forecasts)
forecast_lasso <- as.data.frame(lasso_model$forecasts)
forecast_enet <- as.data.frame(enet_model$forecasts)
forecast_rf <- as.data.frame(rf_model$forecasts)
results_m <- data.frame(date = y_axis,
IBCR_RS = ym,
benchmark_h1 = forecast_bench$init,
benchmark_h12 = forecast_bench$V2,
lasso_h1 = forecast_lasso$init,
lasso_h12 = forecast_lasso$V2,
enet_h1 = forecast_enet$init,
enet_h12 = forecast_enet$V2,
rf_h1 = forecast_rf$init,
rf_h12 = forecast_rf$V2)
qcsfe_lasso = csfe(lasso_modelq, benchmarkq, yq)
qcsfe_enet = csfe(enet_modelq, benchmarkq, yq)
qcsfe_rf = csfe(rf_modelq, benchmarkq, yq)
qcsfe_lasso <- as.data.frame(qcsfe_lasso)
qcsfe_enet <- as.data.frame(qcsfe_enet)
qcsfe_rf <- as.data.frame(qcsfe_rf)
# ================================================
# --------------------Graphs----------------------
# ================================================
message("[10] Collecting results for graph building (see 10_get_Graphs.R)")
y_ax <- dateq[66:93]
csfe_q <- data.frame(date = y_ax,
lasso_h1 = qcsfe_lasso$h1,
lasso_h4 = qcsfe_lasso$h4,
enet_h1 = qcsfe_enet$h1,
enet_h4 = qcsfe_enet$h4,
rf_h1 = qcsfe_rf$h1,
rf_h4 = qcsfe_rf$h4)
forecastq_bench <- as.data.frame(benchmarkq$forecasts)
forecastq_lasso <- as.data.frame(lasso_modelq$forecasts)
forecastq_enet <- as.data.frame(enet_modelq$forecasts)
forecastq_rf <- as.data.frame(rf_modelq$forecasts)
results_q <- data.frame(date = y_ax,
GDP_RS = yq,
benchmark_h1 = forecastq_bench$init,
benchmark_h4 = forecastq_bench$V2,
lasso_h1 = forecastq_lasso$init,
lasso_h4 = forecastq_lasso$V2,
enet_h1 = forecastq_enet$init,
enet_h4 = forecastq_enet$V2,
rf_h1 = forecastq_rf$init,
rf_h4 = forecastq_rf$V2)
CSFE_m <- csfe_m %>%
pivot_longer(
cols = -date,
names_to = c("model", "horizon"),
names_sep = "_"
) %>%
pivot_wider(
names_from = horizon,
values_from = value,
names_prefix = "csfe_"
)
CSFE_q <- csfe_q %>%
pivot_longer(
cols = -date,
names_to = c("model", "horizon"),
names_sep = "_"
) %>%
pivot_wider(
names_from = horizon,
values_from = value,
names_prefix = "csfe_"
)
View(CSFE_m)
View(CSFE_q)
View(CSFE_m)
# -monthly--------------------h12
csfe_mh12 <- CSFE_m %>%
ggplot(aes(x=date, y= csfe_h12, color = model)) +
geom_line(linewidth=0.8) +
geom_hline(yintercept = 0, color = "black", linetype = "dashed") +
labs(title = "Horizon 12",
subtitle =  "Data from Sep/2018 to May/2025",
x = "Date",
y = "CSFE",
color = "Model:") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_color_discrete(labels = c(
"lasso" = "Lasso",
"enet" = "Elastic Net",
"rf" = "Random Forest"
)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw(base_size = 16, base_family = "EB Garamond") +
theme(
plot.margin = margin(4, 8, 2, 8),
axis.title.y = element_text(size = 60, face = "plain"),
axis.text.y  = element_text(size = 60),
axis.text.x  = element_text(size = 60, angle = -90, vjust = 0.5, hjust = 1),
axis.title.x = element_blank(),
plot.title = element_text(size = 70, face = "plain"),
plot.subtitle = element_text(size = 55, face = "plain"),
legend.title = element_text(size = 60, face = "plain"),
legend.text  = element_text(size = 55),
legend.position = "bottom",
legend.direction = "horizontal",
legend.justification = "center",
legend.key.width = unit(1, "cm"),   # ⬅️ Increases the width of each legend key
legend.key.height = unit(1, "cm"),  # ⬅️ Increases vertical space of keys
legend.box.spacing = unit(1, "cm")
)
ggsave("Plots/Csfe - Mh1.png", csfe_mh1, width = 8, height = 6, dpi = 225)
ggsave("Plots/Csfe - Mh12.png", csfe_mh12, width = 8, height = 6, dpi = 225)
View(csfe_qh4)
lasso_model <- call_models1(datasetm, 'LASSO', get_lasso, "ibc_rs")
library(writexl)
# Write to Excel
write_xlsx(results_m, "results_monthly.xlsx")
# Write to Excel
write_xlsx(results_q, "results_quarterly.xlsx")
View(dm_tests_ibc)
dm_tests_ibc[["pvalues"]]
dm_tests[["pvalues"]]
gc()
